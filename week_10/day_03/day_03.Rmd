---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
```


```{r}

house_data <- read_csv("data/kc_house_data.csv")

```


```{r}
house_data
```

Tidy up the data ready for regression:

You might like to think about removing some or all of date, id, sqft_living15, sqft_lot15 and zipcode (lat and long provide a better measure of location in any event).

```{r}
house_data_tidy <- house_data %>%
  select(-c("date", "id", "sqft_living15", "sqft_lot15", "zipcode"))

house_data_tidy
```

Have a think about how to treat waterfront. Should we convert its type?

We converted yr_renovated into a renovated logical variable, indicating whether the property had ever been renovated. You may wish to do the same.

Have a think about how to treat condition and grade? Are they interval or categorical ordinal data types?


Check for aliased variables using the alias() function (this takes in a formula object and a data set). [Hint - formula price ~ . says ‘price varying with all predictors’, this is a suitable input to alias()]. Remove variables that lead to an alias. Check the ‘Elements of multiple regression’ lesson for a dropdown containing further information on finding aliased variables in a dataset.

```{r}
library(modelr)
```


```{r}
alias(lm(price~ ., data = house_data_tidy))
```

```{r}
house_price_tidy <- house_data_tidy %>%
  select(-c("sqft_living", "sqft_above"))
```

Systematically build a regression model containing up to four main effects (remember, a main effect is just a single predictor with coefficient), testing the regression diagnostics as you go

splitting datasets into numeric and non-numeric columns might help ggpairs() run in manageable time, although you will need to add either a price or resid column to the non-numeric dataframe in order to see its correlations with the non-numeric predictors.

```{r}
library(GGally)
```


```{r}
houses_tidy_numeric <- house_price_tidy %>%
  select_if(is.numeric)

houses_tidy_nonnumeric <- house_price_tidy %>%
  select_if(function(x) !is.numeric(x))

houses_tidy_nonnumeric$price <- house_price_tidy$price

ggpairs(houses_tidy_numeric)
ggpairs(houses_tidy_nonnumeric)
```


```{r}
mod1a <- lm(price ~ grade, data = houses_tidy_numeric)

mod1a
```


```{r}
summary(mod1a)
```

```{r}
par(mfrow = c(2,2))
plot(mod1a)
```


```{r}
mod2a <- lm(price ~ condition, data = house_data_tidy)

mod2a
```


```{r}
summary(mod2a)
```

```{r}
house_remianing_resid <- houses_tidy_numeric %>%
  add_residuals(mod1a) %>%
  select(-c("price", "grade"))

house_remianing_resid %>%
  ggpairs(aes(colour = condition, alpha = 0.5))
```


```{r}

par(mfrow = c(2,2))
plot(mod2a)

```

```{r}
anova(mod1a, mod2a)
```

```{r}

mod1b <- lm(price ~ long, data = houses_tidy_numeric)

mod1b

```


```{r}
summary(mod1b)
```

